<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vacaciones en el Sur ‚Äî Turismo en Valdivia</title>
  <meta name="description" content="Tours fluviales y terrestres en Valdivia y la Regi√≥n de los R√≠os. Solicitudes por formulario." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fbfbfb; --paper:#fff; --text:#141414; --muted:#5a5a5a; --line:#e9e9e9;
      --olive:#2f7a3e; --olive2:#3c9a50; --brown:#7b4f1d;
      --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.06); --shadow2:0 18px 45px rgba(0,0,0,.10);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.45}
    a{color:inherit;text-decoration:none}
    .container{width:min(1120px,92vw);margin:0 auto}

    header{position:sticky;top:0;z-index:20;background:rgba(251,251,251,.86);backdrop-filter:blur(10px);border-bottom:1px solid var(--line)}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:14px 0;gap:16px}
    .brand{display:flex;align-items:center;gap:12px;min-width:220px}
    .brand-mark{width:38px;height:38px;border-radius:999px;border:2px solid var(--olive);display:grid;place-items:center;font-weight:800;color:var(--olive)}
    .brand h1{font-size:14px;margin:0;letter-spacing:.08em;text-transform:uppercase;font-weight:600}
    .brand small{display:block;font-size:12px;color:var(--muted);margin-top:2px}
    nav ul{display:flex;gap:18px;list-style:none;padding:0;margin:0;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    nav a{font-size:13px;color:#222;opacity:.9;padding:8px 10px;border-radius:999px}
    nav a:hover{background:#fff;box-shadow:0 2px 10px rgba(0,0,0,.05)}

    .hero{padding:64px 0 30px;text-align:center}
    .kicker{color:var(--olive);letter-spacing:.22em;text-transform:uppercase;font-size:12px;margin-bottom:10px}
    .hero-title{font-family:"Playfair Display",serif;font-size:44px;margin:0}
    .hero-sub{margin:10px auto 0;max-width:820px;color:var(--muted);font-size:15px}

    .banner{
      margin:18px auto 0;max-width:920px;
      background:linear-gradient(135deg,rgba(47,122,62,.10),rgba(123,79,29,.08));
      border:1px solid rgba(47,122,62,.16);
      border-radius:var(--radius);
      padding:18px;
      display:flex;gap:14px;align-items:flex-start;text-align:left;
      box-shadow:var(--shadow);
    }
    .badge{
      flex:0 0 auto;
      background:rgba(47,122,62,.12);
      color:var(--olive);
      border:1px solid rgba(47,122,62,.18);
      padding:8px 10px;border-radius:999px;
      font-size:12px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;
    }
    .banner p{margin:0;color:#2b2b2b;font-size:14px}
    .banner .row{margin-top:10px;display:flex;gap:10px;flex-wrap:wrap}

    section{padding:44px 0}
    .section-head{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;margin-bottom:18px}
    .section-head h2{margin:0;letter-spacing:.18em;text-transform:uppercase;font-weight:500;font-size:22px}
    .section-head .hint{margin:0;color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    @media(max-width:980px){.grid{grid-template-columns:repeat(2,1fr)}.hero-title{font-size:36px}}
    @media(max-width:640px){.grid{grid-template-columns:1fr}.hero-title{font-size:30px}nav ul{gap:10px}.brand{min-width:auto}}

    .card{
      background:var(--paper);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:18px;
      box-shadow:var(--shadow);
      transition:transform .15s ease, box-shadow .15s ease;
      min-height:280px;
      display:flex;flex-direction:column;gap:10px;
    }
    .card:hover{transform:translateY(-2px);box-shadow:var(--shadow2)}
    .tag{
      display:inline-flex;align-items:center;gap:8px;
      font-size:11px;letter-spacing:.12em;text-transform:uppercase;font-weight:700;
      color:#fff;background:var(--olive2);
      padding:6px 10px;border-radius:999px;width:max-content;
    }
    .card h3{margin:0;font-size:18px;font-weight:600;line-height:1.2}
    .meta{display:flex;flex-wrap:wrap;gap:8px;color:var(--muted);font-size:12px}
    .pill{border:1px solid var(--line);background:#fcfcfc;border-radius:999px;padding:6px 10px}
    .desc{color:#3a3a3a;font-size:13px;margin:0;flex:1 1 auto}
    .price{display:flex;gap:10px;flex-wrap:wrap;color:#222;font-size:13px}
    .actions{display:flex;gap:10px;margin-top:4px;flex-wrap:wrap}

    .btn{
      appearance:none;border:0;border-radius:12px;
      padding:10px 12px;font-weight:700;font-size:13px;cursor:pointer;
      display:inline-flex;align-items:center;justify-content:center;gap:8px;
      transition:transform .12s ease,opacity .12s ease,box-shadow .12s ease;
      user-select:none;white-space:nowrap;
    }
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:var(--brown);color:#fff;box-shadow:0 10px 20px rgba(123,79,29,.18)}
    .btn-primary:hover{opacity:.94}
    .btn-ghost{background:#fff;border:1px solid var(--line);color:#222}
    .btn-ghost:hover{box-shadow:0 8px 18px rgba(0,0,0,.06)}
    .btn-olive{background:var(--olive);color:#fff;box-shadow:0 10px 20px rgba(47,122,62,.18)}
    .btn-olive:hover{opacity:.95}

    /* ALOJAMIENTO ‚Äî NUEVO (simple + elegante) */
    .stay{
      position:relative;
      background:var(--paper);
      border:1px solid var(--line);
      border-radius:24px;
      padding:22px;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .stay::before{
      content:"";
      position:absolute; inset:-80px -120px auto auto;
      width:260px; height:260px;
      background:radial-gradient(circle, rgba(47,122,62,.18), rgba(47,122,62,0) 60%);
      transform:rotate(12deg);
      pointer-events:none;
    }
    .stay::after{
      content:"";
      position:absolute; inset:auto auto -110px -140px;
      width:320px; height:320px;
      background:radial-gradient(circle, rgba(123,79,29,.16), rgba(123,79,29,0) 62%);
      pointer-events:none;
    }
    .stay-top{
      display:flex; align-items:flex-start; justify-content:space-between; gap:14px;
      position:relative;
    }
    .stay-brand{
      display:flex; gap:12px; align-items:center;
    }
    .stay-logo{
      width:44px; height:44px; border-radius:14px;
      background:linear-gradient(135deg, rgba(47,122,62,.18), rgba(123,79,29,.12));
      border:1px solid rgba(47,122,62,.18);
      display:grid; place-items:center;
      box-shadow:0 10px 20px rgba(0,0,0,.06);
      flex:0 0 auto;
    }
    .stay-logo svg{width:24px;height:24px}
    .stay h3{
      margin:0;
      font-family:"Playfair Display",serif;
      font-size:26px;
      letter-spacing:.01em;
    }
    .stay-sub{margin:6px 0 0;color:var(--muted);font-size:14px;max-width:68ch}

    .stay-list{
      margin:16px 0 0;
      display:grid;
      gap:10px;
      position:relative;
    }
    .stay-item{
      display:flex; gap:12px; align-items:flex-start;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(233,233,233,.9);
      background:rgba(252,252,252,.92);
    }
    .stay-ico{
      width:34px;height:34px;border-radius:12px;
      display:grid;place-items:center;
      border:1px solid rgba(47,122,62,.16);
      background:rgba(47,122,62,.08);
      flex:0 0 auto;
    }
    .stay-ico svg{width:18px;height:18px}
    .stay-item b{display:block;font-size:14px}
    .stay-item span{display:block;color:var(--muted);font-size:13px;margin-top:2px}

    .stay-footer{
      margin-top:16px;
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      position:relative;
    }
    .zones{
      margin-top:14px;
      display:flex; gap:10px; flex-wrap:wrap;
      position:relative;
    }

    footer{padding:26px 0 60px;border-top:1px solid var(--line);color:var(--muted);font-size:12px;text-align:center}

    /* Modals */
    .backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:60}
    .modal{width:min(640px,96vw);background:var(--paper);border-radius:22px;border:1px solid rgba(255,255,255,.35);box-shadow:0 30px 80px rgba(0,0,0,.22);overflow:hidden}
    .mhead{padding:16px 18px;border-bottom:1px solid var(--line);display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
    .mhead h4{margin:0;font-size:14px;letter-spacing:.12em;text-transform:uppercase;font-weight:700;color:#222}
    .mhead p{margin:8px 0 0;color:var(--muted);font-size:12px}
    .x{border:1px solid var(--line);background:#fff;width:38px;height:38px;border-radius:12px;cursor:pointer;display:grid;place-items:center;font-size:18px;line-height:1}
    .mbody{padding:16px 18px 18px}
    label{display:block;font-size:12px;color:var(--muted);margin:10px 0 6px}
    input, select, textarea{width:100%;padding:12px 12px;border-radius:12px;border:1px solid var(--line);outline:none;font-size:14px;background:#fff;font-family:inherit}
    textarea{min-height:92px;resize:vertical}
    input:focus, select:focus, textarea:focus{border-color:rgba(47,122,62,.45);box-shadow:0 0 0 4px rgba(47,122,62,.10)}
    .two{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:640px){.two{grid-template-columns:1fr}}
    .mactions{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
    .note{margin-top:10px;font-size:12px;color:var(--muted)}
    .info-block{border:1px solid var(--line);border-radius:16px;padding:12px;margin-top:10px;background:#fcfcfc}
    .info-block h5{margin:0 0 6px;font-size:12px;letter-spacing:.12em;text-transform:uppercase;font-weight:800;color:#2b2b2b}
    .info-block p{margin:0;font-size:13px;color:#2f2f2f}

    /* Toast */
    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background:#111;color:#fff;padding:12px 14px;border-radius:14px;box-shadow:0 18px 40px rgba(0,0,0,.25);
      font-size:13px;display:none;z-index:80;max-width:min(560px,92vw)
    }

    /* Floating ‚ÄúSolicitar‚Äù (NUEVO, reemplaza WhatsApp) */
    .float{
      position:fixed; right:18px; bottom:18px;
      width:58px; height:58px; border-radius:18px;
      background:linear-gradient(135deg, var(--olive), var(--brown));
      color:#fff; border:0; cursor:pointer;
      box-shadow:0 18px 40px rgba(0,0,0,.18);
      display:grid; place-items:center;
      z-index:70;
    }
    .float:hover{opacity:.96}
    .float svg{width:24px;height:24px}

    /* Quick menu */
    .qmenu{
      position:fixed; right:18px; bottom:86px;
      width:min(280px, 86vw);
      background:#fff; border:1px solid var(--line);
      border-radius:18px; box-shadow:0 18px 50px rgba(0,0,0,.18);
      padding:12px;
      display:none;
      z-index:75;
    }
    .qmenu h6{margin:0 0 8px;font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:#333}
    .qbtn{width:100%;justify-content:flex-start}
    .qbtn + .qbtn{margin-top:8px}
  </style>
</head>

<body>
  <header>
    <div class="container">
      <div class="nav">
        <a class="brand" href="#inicio">
          <div class="brand-mark">V</div>
          <div>
            <h1>Vacaciones en el Sur</h1>
            <small>Turismo ‚Ä¢ Regi√≥n de los R√≠os</small>
          </div>
        </a>

        <nav>
          <ul>
            <li><a href="#tours-fluviales">Tours fluviales</a></li>
            <li><a href="#tours-terrestres">Tours terrestres</a></li>
            <li><a href="#alojamiento">Alojamiento</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <main id="inicio">
    <div class="container">
      <div class="hero">
        <div class="kicker">Operador tur√≠stico ‚Ä¢ Regi√≥n de los R√≠os</div>
        <h2 class="hero-title">Vacaciones en el Sur de Chile</h2>
        <p class="hero-sub">
          Valdivia, Punucapa, humedales, castillos, selva valdiviana, r√≠os y lagos.
          Una regi√≥n para navegar lento, caminar bonito y volver a tu hogar conociendo los lugares mas hermosos del sur.
        </p>

        <div class="banner">
          <div class="badge">Grupos</div>
          <div style="flex:1 1 auto;">
            <p>
              <b>Familia, grupo, colegio o empresa</b>: Sabemos que un evento importante necesita organizaci√≥n, tiempo y alguien en quien confiar.
En Vacaciones del Sur te ayudamos a planificar todo con calma, para que t√∫ te despreocupes y tus invitados solo se dediquen a disfrutar.
Agenda una reuni√≥n o h√°blanos por WhatsApp y armamos juntos una experiencia bien pensada, a tu ritmo y a la medida de tu grupo.
            </p>
            <div class="row">
              <button class="btn btn-primary" onclick="openMeeting()">Agenda tu reuni√≥n</button>
            </div>
          </div>
        </div>

        <div class="banner">
          <div class="badge">Solicitud</div>
          <p>
           Elige el tour o alojamiento que m√°s te guste, presiona Reservar / Solicitar y deja tu nombre y tel√©fono.
Nos llega tu solicitud y te contactamos al instante para ver todo con calma: horarios, disponibilidad y pagos.          </p>
        </div>
      </div>

      <section id="tours-fluviales">
        <div class="section-head">
          <div>
            <h2>Tours fluviales</h2>
            <p class="hint">Valdivia por agua: castillos, santuarios, humedales, postales.</p>
          </div>
        </div>
        <div class="grid" id="grid-fluviales"></div>
      </section>

      <section id="tours-terrestres">
        <div class="section-head">
          <div>
            <h2>Tours terrestres</h2>
            <p class="hint">Full day, termas, parques y rutas: lo mejor de la regi√≥n.</p>
          </div>
        </div>
        <div class="grid" id="grid-terrestres"></div>
      </section>

      <!-- ALOJAMIENTO (NUEVO, SIMPLE, BONITO) -->
      <section id="alojamiento">
        <div class="section-head">
          <div>
            <h2>Alojamiento</h2>
            <p class="hint">Te mostramos opciones reales seg√∫n zona, fechas y capacidad.</p>
          </div>
        </div>

        <div class="stay">
          <div class="stay-top">
            <div class="stay-brand">
              <div class="stay-logo" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M4 11.5 12 5l8 6.5V20a1 1 0 0 1-1 1h-5v-6H10v6H5a1 1 0 0 1-1-1v-8.5Z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"/>
                </svg>
              </div>
              <div>
                <h3>Tenemos estas opciones de alojamiento</h3>
                <p class="stay-sub">
                  Sin cat√°logo infinito. Solo lo que sirve: t√∫ mandas tu solicitud y nosotros te enviamos alternativas seg√∫n lo que necesitas.
                </p>
              </div>
            </div>
          </div>

          <div class="stay-list">
            <div class="stay-item">
              <div class="stay-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M12 2l2.2 6.2L21 9l-5 3.6L17.8 20 12 16.6 6.2 20 8 12.6 3 9l6.8-.8L12 2Z" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
                </svg>
              </div>
              <div>
                <b>Caba√±as con tinaja, quincho y vista incre√≠ble</b>
                <span>Ideal para desconectarse y hacerlo ‚Äúvacaciones de verdad‚Äù.</span>
              </div>
            </div>

            <div class="stay-item">
              <div class="stay-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M4 15c2-4 6-6 8-6s6 2 8 6c-2 4-6 6-8 6s-6-2-8-6Z" stroke="currentColor" stroke-width="1.6"/>
                  <path d="M6 14.5c1.6-2.6 4.1-4 6-4s4.4 1.4 6 4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
                </svg>
              </div>
              <div>
                <b>Casas de turismo, hoteles en la costa</b>
                <span>Opciones cerca de Niebla / costa y alrededores.</span>
              </div>
            </div>

            <div class="stay-item">
              <div class="stay-ico" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M20 7H4m16 0v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7m16 0-2-3H6L4 7" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round"/>
                  <path d="M9 11h6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
                </svg>
              </div>
              <div>
                <b>Opciones low cost</b>
                <span>Lo importante: limpio, seguro, bien ubicado. Sin humo.</span>
              </div>
            </div>
          </div>

          <div class="stay-footer">
            <button class="btn btn-olive" onclick="openStay()">Solicitar alojamiento</button>
            <div class="note">* Se env√≠a al sistema (webhook). No redirecciona a WhatsApp.</div>
          </div>

          <div class="zones" id="zones"></div>
        </div>
      </section>

      <footer>
        <div>¬© <span id="year"></span> Vacaciones en el Sur ‚Äî Regi√≥n de los R√≠os</div>
      </footer>
    </div>
  </main>

  <!-- Floating: Solicitar (NUEVO) -->
  <button class="float" title="Solicitar" onclick="toggleQuick()" aria-label="Solicitar">
    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M8 7h8M8 11h8M8 15h5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
      <path d="M6 3h12a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="1.6"/>
    </svg>
  </button>

  <div class="qmenu" id="qmenu" role="menu" aria-hidden="true">
    <h6>Qu√© quieres solicitar?</h6>
    <button class="btn btn-ghost qbtn" onclick="jumpTo('#tours-fluviales')">Tours fluviales</button>
    <button class="btn btn-ghost qbtn" onclick="jumpTo('#tours-terrestres')">Tours terrestres</button>
    <button class="btn btn-ghost qbtn" onclick="openStay(); hideQuick();">Alojamiento</button>
    <button class="btn btn-primary qbtn" onclick="openMeeting(); hideQuick();">Agenda reuni√≥n (grupos)</button>
  </div>

  <!-- Modal: Reservar Tour -->
  <div class="backdrop" id="reserveBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="reserveTitle">
      <div class="mhead">
        <div>
          <h4 id="reserveTitle">Reservar</h4>
          <p>Nombre + tel√©fono. Se env√≠a al sistema y te escribimos para horarios y pagos.</p>
        </div>
        <button class="x" onclick="closeReserve()" aria-label="Cerrar">√ó</button>
      </div>

      <div class="mbody">
        <div class="meta" id="reserveMeta" style="margin-bottom:8px;"></div>

        <label for="rNombre">Nombre</label>
        <input id="rNombre" placeholder="Tu nombre" autocomplete="name" />

        <label for="rTelefono">Tel√©fono (WhatsApp)</label>
        <input id="rTelefono" placeholder="+56 9 1234 5678" autocomplete="tel" />

        <div class="mactions">
          <button class="btn btn-primary" id="rBtn" onclick="submitReserve()">Enviar solicitud</button>
          <button class="btn btn-ghost" onclick="closeReserve()">Cancelar</button>
        </div>

        <div class="note">* No hay bot√≥n ‚Äúhablar por WhatsApp‚Äù aqu√≠.</div>
      </div>
    </div>
  </div>

  <!-- Modal: Solicitar Alojamiento -->
  <div class="backdrop" id="stayBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="stayTitle">
      <div class="mhead">
        <div>
          <h4 id="stayTitle">Solicitar alojamiento</h4>
          <p>Zona + fechas + capacidad. Te enviamos alternativas reales.</p>
        </div>
        <button class="x" onclick="closeStay()" aria-label="Cerrar">√ó</button>
      </div>

      <div class="mbody">
        <div class="meta" id="stayMeta" style="margin-bottom:8px;"></div>

        <label for="sNombre">Nombre</label>
        <input id="sNombre" placeholder="Tu nombre" autocomplete="name" />

        <label for="sTelefono">Tel√©fono (WhatsApp)</label>
        <input id="sTelefono" placeholder="+56 9 1234 5678" autocomplete="tel" />

        <div class="two">
          <div>
            <label for="sZona">Zona</label>
            <select id="sZona"></select>
          </div>
          <div>
            <label for="sCap">Capacidad</label>
            <input id="sCap" type="number" min="1" placeholder="Ej: 4" />
          </div>
        </div>

        <div class="two">
          <div>
            <label for="sDesde">Desde</label>
            <input id="sDesde" type="date" />
          </div>
          <div>
            <label for="sHasta">Hasta</label>
            <input id="sHasta" type="date" />
          </div>
        </div>

        <label for="sNota">Detalles (opcional)</label>
        <textarea id="sNota" placeholder="Tinaja s√≠ o s√≠, estacionamiento, cerca del centro, etc."></textarea>

        <div class="mactions">
          <button class="btn btn-olive" id="sBtn" onclick="submitStay()">Enviar solicitud</button>
          <button class="btn btn-ghost" onclick="closeStay()">Cancelar</button>
        </div>

        <div class="note">* Se env√≠a al webhook. No redirecciona.</div>
      </div>
    </div>
  </div>

  <!-- Modal: Agenda Reuni√≥n -->
  <div class="backdrop" id="meetBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="meetTitle">
      <div class="mhead">
        <div>
          <h4 id="meetTitle">Agenda tu reuni√≥n</h4>
          <p>Lun‚ÄìS√°b ¬∑ 08:00 / 09:00 / 10:00 / 18:00 / 19:00 (Chile).</p>
        </div>
        <button class="x" onclick="closeMeeting()" aria-label="Cerrar">√ó</button>
      </div>

      <div class="mbody">
        <label for="mNombre">Nombre</label>
        <input id="mNombre" placeholder="Tu nombre" autocomplete="name" />

        <label for="mTelefono">Tel√©fono (WhatsApp)</label>
        <input id="mTelefono" placeholder="+56 9 1234 5678" autocomplete="tel" />

        <div class="two">
          <div>
            <label for="mDia">D√≠a</label>
            <select id="mDia">
              <option>Lunes</option><option>Martes</option><option>Mi√©rcoles</option>
              <option>Jueves</option><option>Viernes</option><option>S√°bado</option>
            </select>
          </div>
          <div>
            <label for="mHora">Hora</label>
            <select id="mHora">
              <option>08:00</option><option>09:00</option><option>10:00</option><option>18:00</option><option>19:00</option>
            </select>
          </div>
        </div>

        <label for="mNota">Qu√© necesitas? (opcional)</label>
        <textarea id="mNota" placeholder="Somos X personas, queremos fluvial + almuerzo, fecha tentativa‚Ä¶"></textarea>

        <div class="mactions">
          <button class="btn btn-primary" id="mBtn" onclick="submitMeeting()">Solicitar reuni√≥n</button>
          <button class="btn btn-ghost" onclick="closeMeeting()">Cancelar</button>
        </div>

        <div class="note">* Se env√≠a al webhook. No redirecciona.</div>
      </div>
    </div>
  </div>

  <!-- Modal: M√°s informaci√≥n -->
  <div class="backdrop" id="infoBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="infoTitle">
      <div class="mhead">
        <div>
          <h4 id="infoTitle">M√°s informaci√≥n</h4>
          <p id="infoSub">Detalle del tour.</p>
        </div>
        <button class="x" onclick="closeInfo()" aria-label="Cerrar">√ó</button>
      </div>

      <div class="mbody">
        <div class="meta" id="infoMeta" style="margin-bottom:8px;"></div>
        <div id="infoContent"></div>

        <div class="mactions">
          <button class="btn btn-primary" onclick="reserveFromInfo()">Reservar</button>
          <button class="btn btn-ghost" onclick="closeInfo()">Cerrar</button>
        </div>

        <div class="note">* Reservar env√≠a al sistema.</div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    /***** ‚úÖ WEBHOOK (AQU√ç) *****/
    const WEBHOOK_URL = "https://n8n-n8n.bvil2a.easypanel.host/webhook/2e98cf7f-b5fb-490c-8dac-05274a1d59e8";

    /***** ‚úÖ DATA (Tour_detallado) *****/
    const TOURS_TERRESTRES = [
      { id:"terr-1", nombre:"Reserva Huilo Huilo", tipo:"Full day naturaleza",
        descripcion:"Hotel Monta√±a M√°gica, cascadas, museo y caverna volc√°nica‚Ä¶",
        detallado:"Explora la Reserva Biol√≥gica Huilo Huilo visitando el Hotel Monta√±a M√°gica, varias cascadas, el Museo de los Volcanes y una caverna volc√°nica. Combina senderos suaves con tiempo para fotos y descanso en medio de la selva patag√≥nica.",
        duracion_horas:13, opera_dias:"lunes a domingo", max_personas:15, precio_adulto:60000, precio_nino:55000
      },
      { id:"terr-2", nombre:"Termas Huilo-Huilo", tipo:"Full day termas",
        descripcion:"Aguas c√°lidas, barro terap√©utico, r√≠o Ra√±intulelfu‚Ä¶",
        detallado:"Sum√©rgete en piscinas termales de aguas c√°lidas, barro terap√©utico y el sonido del r√≠o Ra√±intulelfu. Es un lugar poco masivo, ideal para relajarse sin multitudes ni filas, combinando aguas termales y entorno natural.",
        duracion_horas:13, opera_dias:"lunes a domingo", max_personas:15, precio_adulto:67000, precio_nino:62000
      },
      { id:"terr-3", nombre:"City Tour Valdivia-Niebla", tipo:"City tour cultural",
        descripcion:"Valdivia + Jard√≠n Bot√°nico + Castillo de Niebla‚Ä¶",
        detallado:"Recorre los principales puntos de Valdivia, visita el Jard√≠n Bot√°nico y termina en el Castillo de Niebla. Es una experiencia que mezcla cultura, patrimonio e historia con naturaleza y breves caminatas en pasarelas y senderos.",
        duracion_horas:6, opera_dias:"lunes a domingo", max_personas:15, precio_adulto:20000, precio_nino:15000
      },
      { id:"terr-4", nombre:"Parque Futangue", tipo:"Full day trekking",
        descripcion:"Laguna Pichi + Saltos + Futrono‚Ä¶",
        detallado:"Explora el Parque Futangue con un trekking hacia la Laguna Pichi, visita los Saltos de Ri√±inahue y Nilahue y termina con el encanto de Futrono. Es una jornada de aventura con caminatas de intensidad media y paisajes de monta√±a y bosque.",
        duracion_horas:13, opera_dias:"lunes a domingo", max_personas:15, precio_adulto:64000, precio_nino:59000
      },
      { id:"terr-5", nombre:"Parque Alerce Costero", tipo:"Full day naturaleza",
        descripcion:"Bosque valdiviano + Alerce Milenario‚Ä¶",
        detallado:"La excursi√≥n permite adentrarse en el bosque valdiviano del Parque Alerce Costero y realizar una caminata por senderos que llevan al Alerce Milenario, un √°rbol con miles de a√±os de antig√ºedad. Es una experiencia de conexi√≥n con la naturaleza en un paisaje de paz y majestuosidad.",
        duracion_horas:13, opera_dias:"lunes a domingo", max_personas:15, precio_adulto:64000, precio_nino:59000
      },
      { id:"terr-6", nombre:"Parque Oncol", tipo:"Full day cultura y naturaleza",
        descripcion:"City tour + almuerzo t√≠pico + mirador Oncol‚Ä¶",
        detallado:"La excursi√≥n mezcla un city tour por Valdivia con una visita al Parque Oncol. Luego de un almuerzo t√≠pico se explora la selva valdiviana y se asciende al mirador del cerro Oncol para obtener vistas panor√°micas, finalizando con un regreso pintoresco por la costa.",
        duracion_horas:13, opera_dias:"lunes a domingo", max_personas:15, precio_adulto:50000, precio_nino:45000
      },
      { id:"terr-7", nombre:"Termas Geom√©tricas", tipo:"Full day termas",
        descripcion:"Pasarelas rojas + piscinas termales 35‚Äì42¬∞C‚Ä¶",
        detallado:"Las Termas Geom√©tricas son un complejo termal ubicado dentro del Parque Nacional Villarrica. Destacan por sus pasarelas de madera roja que conectan varias piscinas de aguas termales entre treinta y cinco y cuarenta y dos grados, ofreciendo una experiencia de relajaci√≥n en medio de la naturaleza.",
        duracion_horas:13, opera_dias:"lunes a domingo", max_personas:15, precio_adulto:80000, precio_nino:75000
      }
    ];

    const TOURS_FLUVIALES = [
      { id:"fluv-1", nombre:"Corral-Mancera", nivel:"Servicio guiado",
        descripcion:"Barco Neptuno hasta bah√≠a de Corral + castillos espa√±oles‚Ä¶",
        detallado:"navegaci√≥n en barco Neptuno por los r√≠os de Valdivia hasta la desembocadura en bahia de Corral, visitando los castillos espa√±oles de Corral y Mancera. Incluye almuerzo y once a bordo y relato hist√≥rico con servicio guiado.",
        duracion_horas:5, origen:"Valdivia", destino:"Castillos de Corral y Mancera", incluye_comidas:"Almuerzo y once a bordo",
        precio_adulto:35000, precio_nino:28000
      },
      { id:"fluv-2", nombre:"Punucapa", nivel:"Servicio guiado",
        descripcion:"Santuario Anwandter + Punucapa + degustaciones + feria‚Ä¶",
        detallado:"El tour a Punucapa ofrece navegaci√≥n hacia el Santuario Natural Carlos Anwandter, visita de la pintoresca localidad de Punucapa, degustaciones, suave caminata, feria costumbrista, visita a la iglesia de la virgen de la candelaria, sale desde Valdivia. Servicio guiado.",
        duracion_horas:3.5, origen:"Valdivia", destino:"Punucapa y Santuario Carlos Anwandter", incluye_comidas:"Degustaciones",
        precio_adulto:12000, precio_nino:9600
      },
      { id:"fluv-3", nombre:"Isla Teja - City tour", nivel:"Servicio guiado",
        descripcion:"R√≠os y puentes + Santuario Anwandter + historia a bordo‚Ä¶",
        detallado:"Recorrido por los principales r√≠os y puentes de Valdivia, rodeando la Isla Teja y navegando por aguas del Santuario de la Naturaleza Carlos Anwandter. Servicio guiado a bordo del barco Calle Calle con √©nfasis en la historia de la ciudad.",
        duracion_horas:1, origen:"Valdivia", destino:"Isla Teja y r√≠os de Valdivia",
        precio_adulto:5000, precio_nino:4000
      },
      { id:"fluv-4", nombre:"Santuario-Humedales", nivel:"Servicio guiado",
        descripcion:"Humedales del Santuario + flora/fauna + paisajes‚Ä¶",
        detallado:"navegaci√≥n visitar√°s humedales de Valdivia dentro del Santuario de la Naturaleza Carlos Anwandter, disfrutando de paisajes y observaci√≥n de flora y fauna con servicio guiado.",
        duracion_horas:1.5, origen:"Valdivia", destino:"Humedales del Santuario Carlos Anwandter",
        precio_adulto:5000, precio_nino:4000
      }
    ];

    const ALOJ_ZONAS = ["Collico","Estaci√≥n","Isla Teja","Niebla / Costa","Centro Valdivia",];

    /***** Utils *****/
    const fmtCLP = (n) => (n===null||n===undefined||n==="") ? "" : "$" + Number(n).toLocaleString("es-CL");
    const el = (tag, attrs={}, children=[]) => {
      const node=document.createElement(tag);
      Object.entries(attrs).forEach(([k,v])=>{
        if(k==="class") node.className=v;
        else if(k.startsWith("on") && typeof v==="function") node.addEventListener(k.slice(2), v);
        else node.setAttribute(k,v);
      });
      children.forEach(c=>node.appendChild(typeof c==="string"?document.createTextNode(c):c));
      return node;
    };
    const cleanText = (s) => (s||"").toString().replace(/\s+/g," ").trim();
    const normalizePhone = (raw) => {
      let d=(raw||"").toString().replace(/\D/g,"");
      if(!d) return "";
      if(d.startsWith("00")) d=d.slice(2);
      d=d.replace(/^0+/,"");
      if(d.startsWith("56")) return d;
      if(d.length===9 && d.startsWith("9")) return "56"+d;
      if(d.length===8) return "56"+d;
      return d;
    };
    const toast = (msg) => {
      const t=document.getElementById("toast");
      t.textContent=msg; t.style.display="block";
      clearTimeout(window.__toastTimer);
      window.__toastTimer=setTimeout(()=>t.style.display="none", 4200);
    };

    async function postToWebhook(payload){
      if(!WEBHOOK_URL) return false;

      const fullPayload = {
        ...payload,
        catalog: { tours_fluviales: TOURS_FLUVIALES, tours_terrestres: TOURS_TERRESTRES }
      };

      try{
        await fetch(WEBHOOK_URL, {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify(fullPayload)
        });
        return true;
      }catch(e){
        try{
          await fetch(WEBHOOK_URL, {
            method:"POST",
            mode:"no-cors",
            headers:{ "Content-Type":"text/plain;charset=UTF-8" },
            body: JSON.stringify(fullPayload)
          });
          return true;
        }catch(e2){
          console.warn("Webhook fall√≥:", e2);
          return false;
        }
      }
    }

    /***** Render Tours *****/
    function buildCard(t, label){
      const meta=[];
      if(t.duracion_horas) meta.push(`‚è±Ô∏è ${t.duracion_horas} h`);
      if(t.origen) meta.push(`üìç Salida: ${t.origen}`);
      if(t.destino) meta.push(`üß≠ Destino: ${t.destino}`);
      if(t.tipo) meta.push(`üß© ${t.tipo}`);
      if(t.nivel) meta.push(`üß≠ ${t.nivel}`);

      const price=[];
      if(t.precio_adulto) price.push(`Adulto: ${fmtCLP(t.precio_adulto)}`);
      if(t.precio_nino) price.push(`Ni√±o: ${fmtCLP(t.precio_nino)}`);

      return el("div",{class:"card"},[
        el("div",{class:"tag"},[label]),
        el("h3",{},[t.nombre]),
        el("div",{class:"meta"}, meta.map(m=>el("span",{class:"pill"},[m]))),
        el("p",{class:"desc"},[t.descripcion||"‚Äî"]),
        el("div",{class:"price"}, price.length ? price.map(p=>el("span",{},[p])) : [el("span",{style:"color:var(--muted)"},["Precio a consultar"])]),
        el("div",{class:"actions"},[
          el("button",{class:"btn btn-primary", onclick:()=>openReserve({tipo:label, nombre:t.nombre, id:t.id, tour:t})},["Reservar"]),
          el("button",{class:"btn btn-ghost", onclick:()=>openInfo(t,label)},["M√°s informaci√≥n"])
        ])
      ]);
    }

    function render(){
      document.getElementById("year").textContent = new Date().getFullYear();

      const fl=document.getElementById("grid-fluviales");
      TOURS_FLUVIALES.forEach(t=>fl.appendChild(buildCard(t,"Tour fluvial")));

      const te=document.getElementById("grid-terrestres");
      TOURS_TERRESTRES.forEach(t=>te.appendChild(buildCard(t,"Tour terrestre")));

      const zones=document.getElementById("zones");
      ALOJ_ZONAS.forEach(z=>zones.appendChild(el("span",{class:"pill"},[z])));

      const sZona=document.getElementById("sZona");
      ALOJ_ZONAS.forEach(z=>sZona.appendChild(el("option",{value:z},[z])));
    }

    /***** Quick menu (floating) *****/
    function toggleQuick(){
      const q=document.getElementById("qmenu");
      const isOpen = q.style.display==="block";
      q.style.display = isOpen ? "none" : "block";
      q.setAttribute("aria-hidden", isOpen ? "true" : "false");
    }
    function hideQuick(){
      const q=document.getElementById("qmenu");
      q.style.display="none";
      q.setAttribute("aria-hidden","true");
    }
    function jumpTo(hash){
      hideQuick();
      document.querySelector(hash)?.scrollIntoView({behavior:"smooth", block:"start"});
    }

    /***** Reserve Tour modal *****/
    let selected=null;
    function openReserve(p){
      selected=p;
      const b=document.getElementById("reserveBackdrop");
      const meta=document.getElementById("reserveMeta");
      meta.innerHTML="";
      meta.appendChild(el("span",{class:"pill"},[`üìå ${p.tipo}`]));
      meta.appendChild(el("span",{class:"pill"},[`üó∫Ô∏è ${p.nombre}`]));

      document.getElementById("rNombre").value="";
      document.getElementById("rTelefono").value="";
      b.style.display="flex"; b.setAttribute("aria-hidden","false");
      setTimeout(()=>document.getElementById("rNombre").focus(),60);
    }
    function closeReserve(){
      const b=document.getElementById("reserveBackdrop");
      b.style.display="none"; b.setAttribute("aria-hidden","true");
      selected=null;
    }
    async function submitReserve(){
      const btn=document.getElementById("rBtn");
      const nombre=cleanText(document.getElementById("rNombre").value);
      const telRaw=cleanText(document.getElementById("rTelefono").value);
      const telefono=normalizePhone(telRaw);
      if(!nombre||!telefono){ alert("Falta nombre o tel√©fono."); return; }

      btn.disabled=true; btn.textContent="Enviando‚Ä¶";

      const payload={
        source:"vacacionesenelsur_web",
        created_at:new Date().toISOString(),
        event:"reserva_tour",
        timezone:"America/Santiago",
        tipo:selected?.tipo||"Solicitud",
        item:selected?.nombre||"Consulta",
        item_id:selected?.id||null,
        nombre,
        telefono,
        telefono_raw:telRaw,
        tour_data:selected?.tour||null
      };

      const ok=await postToWebhook(payload);

      btn.disabled=false; btn.textContent="Enviar solicitud";
      if(!ok){ alert("No se pudo enviar. Revisa el webhook."); return; }

      closeReserve();
      toast("‚úÖ Solicitud enviada. Te escribimos por WhatsApp para horarios y pagos.");
    }

    /***** Stay modal *****/
    function openStay(){
      const b=document.getElementById("stayBackdrop");
      const meta=document.getElementById("stayMeta");
      meta.innerHTML="";
      meta.appendChild(el("span",{class:"pill"},["üè° Alojamiento"]));

      document.getElementById("sNombre").value="";
      document.getElementById("sTelefono").value="";
      document.getElementById("sZona").value="Indiferente";
      document.getElementById("sCap").value="";
      document.getElementById("sDesde").value="";
      document.getElementById("sHasta").value="";
      document.getElementById("sNota").value="";

      b.style.display="flex"; b.setAttribute("aria-hidden","false");
      setTimeout(()=>document.getElementById("sNombre").focus(),60);
    }
    function closeStay(){
      const b=document.getElementById("stayBackdrop");
      b.style.display="none"; b.setAttribute("aria-hidden","true");
    }
    async function submitStay(){
      const btn=document.getElementById("sBtn");
      const nombre=cleanText(document.getElementById("sNombre").value);
      const telRaw=cleanText(document.getElementById("sTelefono").value);
      const telefono=normalizePhone(telRaw);
      if(!nombre||!telefono){ alert("Falta nombre o tel√©fono."); return; }

      btn.disabled=true; btn.textContent="Enviando‚Ä¶";

      const payload={
        source:"vacacionesenelsur_web",
        created_at:new Date().toISOString(),
        event:"solicitud_alojamiento",
        timezone:"America/Santiago",
        nombre,
        telefono,
        telefono_raw:telRaw,
        alojamiento:{
          zona: document.getElementById("sZona").value,
          capacidad: Number(document.getElementById("sCap").value || 0) || null,
          fechas:{ desde: document.getElementById("sDesde").value || null, hasta: document.getElementById("sHasta").value || null },
          nota: cleanText(document.getElementById("sNota").value) || null
        }
      };

      const ok=await postToWebhook(payload);

      btn.disabled=false; btn.textContent="Enviar solicitud";
      if(!ok){ alert("No se pudo enviar. Revisa el webhook."); return; }

      closeStay();
      toast("‚úÖ Solicitud enviada. Te escribimos por WhatsApp para coordinar.");
    }

    /***** Meeting modal *****/
    function openMeeting(){
      const b=document.getElementById("meetBackdrop");
      document.getElementById("mNombre").value="";
      document.getElementById("mTelefono").value="";
      document.getElementById("mDia").value="Lunes";
      document.getElementById("mHora").value="08:00";
      document.getElementById("mNota").value="";
      b.style.display="flex"; b.setAttribute("aria-hidden","false");
      setTimeout(()=>document.getElementById("mNombre").focus(),60);
    }
    function closeMeeting(){
      const b=document.getElementById("meetBackdrop");
      b.style.display="none"; b.setAttribute("aria-hidden","true");
    }
    async function submitMeeting(){
      const btn=document.getElementById("mBtn");
      const nombre=cleanText(document.getElementById("mNombre").value);
      const telRaw=cleanText(document.getElementById("mTelefono").value);
      const telefono=normalizePhone(telRaw);
      if(!nombre||!telefono){ alert("Falta nombre o tel√©fono."); return; }

      btn.disabled=true; btn.textContent="Enviando‚Ä¶";

      const payload={
        source:"vacacionesenelsur_web",
        created_at:new Date().toISOString(),
        event:"reunion",
        timezone:"America/Santiago",
        nombre,
        telefono,
        telefono_raw:telRaw,
        disponibilidad:{
          dia: document.getElementById("mDia").value,
          hora: document.getElementById("mHora").value,
          rango:"Lun-S√°b 08/09/10 y 18/19"
        },
        nota: cleanText(document.getElementById("mNota").value) || null
      };

      const ok=await postToWebhook(payload);

      btn.disabled=false; btn.textContent="Solicitar reuni√≥n";
      if(!ok){ alert("No se pudo enviar. Revisa el webhook."); return; }

      closeMeeting();
      toast("‚úÖ Reuni√≥n solicitada. Te escribimos para confirmar.");
    }

    /***** Info modal *****/
    let infoSelected=null;
    function openInfo(t,label){
      infoSelected={t,label};
      const b=document.getElementById("infoBackdrop");
      document.getElementById("infoTitle").textContent = t.nombre || "M√°s informaci√≥n";
      document.getElementById("infoSub").textContent = `${label} ¬∑ Detalle`;

      const meta=document.getElementById("infoMeta");
      const content=document.getElementById("infoContent");
      meta.innerHTML="";
      const pills=[];
      if(t.duracion_horas) pills.push(`‚è±Ô∏è ${t.duracion_horas} h`);
      if(t.origen) pills.push(`üìç ${t.origen}`);
      if(t.destino) pills.push(`üß≠ ${t.destino}`);
      if(t.tipo) pills.push(`üß© ${t.tipo}`);
      if(t.nivel) pills.push(`üß≠ ${t.nivel}`);
      if(t.opera_dias) pills.push(`üìÖ ${t.opera_dias}`);
      if(t.max_personas) pills.push(`üë• m√°x ${t.max_personas}`);
      pills.forEach(p=>meta.appendChild(el("span",{class:"pill"},[p])));

      content.innerHTML="";
      content.appendChild(el("div",{class:"info-block"},[
        el("h5",{},["Descripci√≥n"]),
        el("p",{},[t.detallado || t.descripcion || "Sin detalle todav√≠a."])
      ]));

      const priceLine=[];
      if(t.precio_adulto) priceLine.push(`Adulto: ${fmtCLP(t.precio_adulto)}`);
      if(t.precio_nino) priceLine.push(`Ni√±o: ${fmtCLP(t.precio_nino)}`);
      if(priceLine.length){
        content.appendChild(el("div",{class:"info-block"},[
          el("h5",{},["Precios"]),
          el("p",{},[priceLine.join(" ¬∑ ")])
        ]));
      }
      if(t.incluye_comidas){
        content.appendChild(el("div",{class:"info-block"},[
          el("h5",{},["Incluye"]),
          el("p",{},[t.incluye_comidas])
        ]));
      }

      b.style.display="flex"; b.setAttribute("aria-hidden","false");
    }
    function closeInfo(){
      const b=document.getElementById("infoBackdrop");
      b.style.display="none"; b.setAttribute("aria-hidden","true");
      infoSelected=null;
    }
    function reserveFromInfo(){
      if(!infoSelected?.t) return;
      const t=infoSelected.t;
      const label=infoSelected.label || "Tour";
      closeInfo();
      openReserve({tipo:label, nombre:t.nombre, id:t.id, tour:t});
    }

    /* Close outside + ESC */
    document.addEventListener("click",(e)=>{
      const ids=["reserveBackdrop","stayBackdrop","meetBackdrop","infoBackdrop"];
      ids.forEach(id=>{
        const b=document.getElementById(id);
        if(b.style.display==="flex" && e.target===b){
          if(id==="reserveBackdrop") closeReserve();
          if(id==="stayBackdrop") closeStay();
          if(id==="meetBackdrop") closeMeeting();
          if(id==="infoBackdrop") closeInfo();
        }
      });

      const q=document.getElementById("qmenu");
      const floatBtn=document.querySelector(".float");
      if(q.style.display==="block" && !q.contains(e.target) && e.target!==floatBtn){
        hideQuick();
      }
    });
    document.addEventListener("keydown",(e)=>{
      if(e.key==="Escape"){ closeReserve(); closeStay(); closeMeeting(); closeInfo(); hideQuick(); }
    });

    render();
  </script>
</body>
</html>

